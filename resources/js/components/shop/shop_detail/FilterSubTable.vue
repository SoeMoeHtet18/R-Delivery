<template>
     <div class="flex justify-end">
        <div class="flex items-center mr-9" v-if="isFilter">
            <h5 class="from-label">From</h5>
            <DxDateBox
                v-model="fromDate"
                class="date-box"
                width="204px"
                height="30"
                type="date"
            />
            <h5 class="to-label">To</h5>
            <DxDateBox
                v-model="toDate"
                class="date-box"
                width="204px"
                height="30"
                type="date"
            />
        </div>
        <div @click="filterData">
            <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g id="calendar">
                    <rect id="Rectangle 72" width="30" height="30" rx="5" fill="#116A5B"/>
                    <path id="calendar_2" d="M10.673 5C10.8587 5 11.0367 5.07375 11.168 5.20503C11.2993 5.3363 11.373 5.51435 11.373 5.7V7.009H18.89V5.709C18.89 5.52335 18.9637 5.3453 19.095 5.21403C19.2263 5.08275 19.4043 5.009 19.59 5.009C19.7757 5.009 19.9537 5.08275 20.085 5.21403C20.2162 5.3453 20.29 5.52335 20.29 5.709V7.009H23C23.5303 7.009 24.0388 7.21958 24.4139 7.59443C24.7889 7.96929 24.9997 8.47774 25 9.008V23.001C24.9997 23.5313 24.7889 24.0397 24.4139 24.4146C24.0388 24.7894 23.5303 25 23 25H7C6.46974 25 5.96118 24.7894 5.58614 24.4146C5.2111 24.0397 5.00027 23.5313 5 23.001V9.008C5.00027 8.47774 5.2111 7.96929 5.58614 7.59443C5.96118 7.21958 6.46974 7.009 7 7.009H9.973V5.699C9.97327 5.51352 10.0471 5.33573 10.1784 5.20467C10.3096 5.07361 10.4875 5 10.673 5ZM6.4 12.742V23.001C6.4 23.0798 6.41552 23.1578 6.44567 23.2306C6.47583 23.3034 6.52002 23.3696 6.57574 23.4253C6.63145 23.481 6.69759 23.5252 6.77039 23.5553C6.84319 23.5855 6.92121 23.601 7 23.601H23C23.0788 23.601 23.1568 23.5855 23.2296 23.5553C23.3024 23.5252 23.3686 23.481 23.4243 23.4253C23.48 23.3696 23.5242 23.3034 23.5543 23.2306C23.5845 23.1578 23.6 23.0798 23.6 23.001V12.756L6.4 12.742ZM11.667 19.619V21.285H10V19.619H11.667ZM15.833 19.619V21.285H14.167V19.619H15.833ZM20 19.619V21.285H18.333V19.619H20ZM11.667 15.642V17.308H10V15.642H11.667ZM15.833 15.642V17.308H14.167V15.642H15.833ZM20 15.642V17.308H18.333V15.642H20ZM9.973 8.408H7C6.92121 8.408 6.84319 8.42352 6.77039 8.45367C6.69759 8.48382 6.63145 8.52802 6.57574 8.58374C6.52002 8.63945 6.47583 8.70559 6.44567 8.77839C6.41552 8.85119 6.4 8.92921 6.4 9.008V11.343L23.6 11.357V9.008C23.6 8.92921 23.5845 8.85119 23.5543 8.77839C23.5242 8.70559 23.48 8.63945 23.4243 8.58374C23.3686 8.52802 23.3024 8.48382 23.2296 8.45367C23.1568 8.42352 23.0788 8.408 23 8.408H20.29V9.337C20.29 9.52265 20.2162 9.7007 20.085 9.83197C19.9537 9.96325 19.7757 10.037 19.59 10.037C19.4043 10.037 19.2263 9.96325 19.095 9.83197C18.9637 9.7007 18.89 9.52265 18.89 9.337V8.408H11.373V9.328C11.373 9.51365 11.2993 9.6917 11.168 9.82297C11.0367 9.95425 10.8587 10.028 10.673 10.028C10.4873 10.028 10.3093 9.95425 10.178 9.82297C10.0468 9.6917 9.973 9.51365 9.973 9.328V8.408Z" fill="white"/>
                </g>
            </svg>
        </div>
        <div class="ml-3" @click="downloadData" v-if="downloadable">
            <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g id="download">
                    <rect id="Rectangle 71" width="30" height="30" rx="5" fill="#116A5B"/>
                    <path id="Vector" d="M25 17.5V23.3333C25 23.7754 24.8244 24.1993 24.5118 24.5118C24.1993 24.8244 23.7754 25 23.3333 25H6.66667C6.22464 25 5.80072 24.8244 5.48816 24.5118C5.17559 24.1993 5 23.7754 5 23.3333V17.5C5 17.279 5.0878 17.067 5.24408 16.9107C5.40036 16.7545 5.61232 16.6667 5.83333 16.6667C6.05435 16.6667 6.26631 16.7545 6.42259 16.9107C6.57887 17.067 6.66667 17.279 6.66667 17.5V23.3333H23.3333V17.5C23.3333 17.279 23.4211 17.067 23.5774 16.9107C23.7337 16.7545 23.9457 16.6667 24.1667 16.6667C24.3877 16.6667 24.5996 16.7545 24.7559 16.9107C24.9122 17.067 25 17.279 25 17.5ZM14.4104 18.0896C14.4878 18.1671 14.5797 18.2285 14.6809 18.2705C14.782 18.3124 14.8905 18.334 15 18.334C15.1095 18.334 15.218 18.3124 15.3191 18.2705C15.4203 18.2285 15.5122 18.1671 15.5896 18.0896L19.7563 13.9229C19.8337 13.8455 19.8951 13.7536 19.937 13.6524C19.9789 13.5513 20.0005 13.4428 20.0005 13.3333C20.0005 13.2238 19.9789 13.1154 19.937 13.0143C19.8951 12.9131 19.8337 12.8212 19.7563 12.7437C19.6788 12.6663 19.5869 12.6049 19.4857 12.563C19.3846 12.5211 19.2762 12.4995 19.1667 12.4995C19.0572 12.4995 18.9487 12.5211 18.8476 12.563C18.7464 12.6049 18.6545 12.6663 18.5771 12.7437L15.8333 15.4885V5.83333C15.8333 5.61232 15.7455 5.40036 15.5893 5.24408C15.433 5.0878 15.221 5 15 5C14.779 5 14.567 5.0878 14.4107 5.24408C14.2545 5.40036 14.1667 5.61232 14.1667 5.83333V15.4885L11.4229 12.7437C11.2665 12.5874 11.0545 12.4995 10.8333 12.4995C10.6122 12.4995 10.4001 12.5874 10.2437 12.7437C10.0874 12.9001 9.99954 13.1122 9.99954 13.3333C9.99954 13.5545 10.0874 13.7666 10.2437 13.9229L14.4104 18.0896Z" fill="white"/>
                </g>
            </svg>
        </div>
    </div>
</template>
<script>
import DxDateBox from 'devextreme-vue/date-box';

export default {
    props: {
        downloadable: Boolean
    },
    data() {
        return {
            isFilter : false,
            fromDate: null,
            toDate: null,
        }
    },
    components: {
        DxDateBox
    },
    methods: {
        downloadData() {
            let toDate = this.toDate;
            if(this.toDate) {
                toDate = new Date(this.toDate);
                toDate.setHours(23, 59, 59, 999);
            }
            this.$emit('download', {
                fromDate: this.fromDate,
                toDate: toDate
            });
        },
        filterData() {
            this.isFilter = !this.isFilter;
        }
    },
    watch: {
        fromDate(newFromDate, oldFromDate) {
            let toDate = this.toDate;
            if(this.toDate) {
                toDate = new Date(this.toDate);
                toDate.setHours(23, 59, 59, 999);
            }

            this.$emit('callApiFilter', {
                fromDate: newFromDate,
                toDate: toDate
            });
        },
        toDate(newToDate, oldToDate) {
            const toDate = new Date(newToDate);
            toDate.setHours(23, 59, 59, 999);

            this.$emit('callApiFilter', {
                fromDate: this.fromDate,
                toDate: toDate
            });
        }
    }
}
</script>